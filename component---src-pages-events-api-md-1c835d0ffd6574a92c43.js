"use strict";(self.webpackChunkcommerce_extensibility=self.webpackChunkcommerce_extensibility||[]).push([[9885],{91973:function(e,n,t){t.r(n),t.d(n,{_frontmatter:function(){return m},default:function(){return u}});var a=t(58168),r=t(80045),i=(t(88763),t(15680)),o=t(83407);const d=["components"],m={},l=(s="InlineAlert",function(e){return console.warn("Component "+s+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.mdx)("div",e)});var s;const p={_frontmatter:m},c=o.A;function u(e){let{components:n}=e,t=(0,r.A)(e,d);return(0,i.mdx)(c,(0,a.A)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,i.mdx)("h1",{id:"rest-endpoints-for-eventing"},"REST endpoints for eventing"),(0,i.mdx)("p",null,"Adobe Commerce provides several REST endpoints that interact with the eventing processes. These endpoints require an ",(0,i.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/commerce/webapi/rest/tutorials/prerequisite-tasks/"},"admin token"),"."),(0,i.mdx)("h2",{id:"subscribe-to-events"},"Subscribe to events"),(0,i.mdx)("p",null,"The ",(0,i.mdx)("inlineCode",{parentName:"p"},"POST /rest/<store_view_code>/V1/eventing/eventSubscribe")," endpoint subscribes the event defined in the payload. The request body has the following format:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-json"},'{\n  "event": {\n    "name": "string",\n    "parent": "string",\n    "fields": [\n      {\n        "name": "string",\n        "converter": "string"\n      }\n    ],\n    "rules": [\n      {\n        "field": "string",\n        "operator": "string",\n        "value": "string"\n      }\n    ],\n    "destination": "string",\n    "priority": true\n  },\n  "force": true\n}\n')),(0,i.mdx)(l,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,i.mdx)("p",null,"After you subscribe to a ",(0,i.mdx)("inlineCode",{parentName:"p"},"plugin-type")," event, you must manually generate the module that defines the event plugins. ",(0,i.mdx)("a",{parentName:"p",href:"commands.md#generate-a-commerce-module-based-on-a-list-of-subscribed-events"},"events:generate:module")),(0,i.mdx)("p",null,(0,i.mdx)("strong",{parentName:"p"},"Headers:")),(0,i.mdx)("p",null,(0,i.mdx)("inlineCode",{parentName:"p"},"Content-Type: application/json"),"\n",(0,i.mdx)("inlineCode",{parentName:"p"},"Authorization: Bearer <administrator token>")),(0,i.mdx)("p",null,"The administrator must be granted access to the ",(0,i.mdx)("inlineCode",{parentName:"p"},"Magento_AdobeIoEventsClient::event_subscribe")," resource."),(0,i.mdx)("p",null,(0,i.mdx)("strong",{parentName:"p"},"Payload Parameters:")),(0,i.mdx)("p",null,"Review the ",(0,i.mdx)("a",{parentName:"p",href:"./commands.md#subscribe-to-an-event"},(0,i.mdx)("inlineCode",{parentName:"a"},"events:subscribe")," command")," to understand the possible values for each item in the request body payload."),(0,i.mdx)("p",null,(0,i.mdx)("strong",{parentName:"p"},"Example usage:")),(0,i.mdx)("p",null,"The following cURL command subscribes to the ",(0,i.mdx)("inlineCode",{parentName:"p"},"observer.catalog_category_save_after")," event. The events contain the ",(0,i.mdx)("inlineCode",{parentName:"p"},"name")," and ",(0,i.mdx)("inlineCode",{parentName:"p"},"entity_id")," field. The priority setting expedites the transmission of this event."),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-bash"},'curl -i -X POST \\\n   -H "Content-Type:application/json" \\\n   -H "Authorization:Bearer <AUTH_TOKEN>" \\\n   -d \\\n\'{\n  "event": {\n    "name": "observer.catalog_category_save_after",\n    "fields": [\n      {\n        "name": "name"\n      },\n      {\n        "name": "entity_id"\n      }\n    ],\n    "priority": true\n  }\n}\' \\\n \'<ADOBE_COMMERCE_URL>/rest/all/V1/eventing/eventSubscribe\'\n')),(0,i.mdx)("h2",{id:"configure-commerce-eventing"},"Configure Commerce eventing"),(0,i.mdx)("p",null,"The ",(0,i.mdx)("inlineCode",{parentName:"p"},"PUT /rest/<store_view_code>/V1/eventing/updateConfiguration")," endpoint updates the Adobe I/O ",(0,i.mdx)("a",{parentName:"p",href:"configure-commerce.md"},"eventing configuration")," originally defined on the ",(0,i.mdx)("strong",{parentName:"p"},"Stores")," > Settings > ",(0,i.mdx)("strong",{parentName:"p"},"Configuration")," > ",(0,i.mdx)("strong",{parentName:"p"},"Adobe Services")," > ",(0,i.mdx)("strong",{parentName:"p"},"Adobe I/O Events")," > ",(0,i.mdx)("strong",{parentName:"p"},"General configuration")," page of the Admin."),(0,i.mdx)("p",null,"The request body has the following format:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-json"},'{\n  "config": {\n    "enabled": true,\n    "merchant_id": "string",\n    "environment_id": "string",\n    "provider_id": "string",\n    "instance_id": "string",\n    "workspace_configuration": "string"\n  }\n}\n')),(0,i.mdx)("p",null,(0,i.mdx)("strong",{parentName:"p"},"Headers:")),(0,i.mdx)("p",null,(0,i.mdx)("inlineCode",{parentName:"p"},"Content-Type: application/json"),"\n",(0,i.mdx)("inlineCode",{parentName:"p"},"Authorization: Bearer <administrator token>")),(0,i.mdx)("p",null,"The administrator must be granted access to the ",(0,i.mdx)("inlineCode",{parentName:"p"},"Magento_AdobeIoEventsClient::configuration_update")," resource."),(0,i.mdx)("p",null,(0,i.mdx)("strong",{parentName:"p"},"Payload Parameters:")),(0,i.mdx)("p",null,"All parameters are optional."),(0,i.mdx)("table",null,(0,i.mdx)("thead",{parentName:"table"},(0,i.mdx)("tr",{parentName:"thead"},(0,i.mdx)("th",{parentName:"tr",align:null},"Name"),(0,i.mdx)("th",{parentName:"tr",align:null},"Format"),(0,i.mdx)("th",{parentName:"tr",align:null},"Description"))),(0,i.mdx)("tbody",{parentName:"table"},(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"enabled")),(0,i.mdx)("td",{parentName:"tr",align:null},"boolean"),(0,i.mdx)("td",{parentName:"tr",align:null},"A ",(0,i.mdx)("inlineCode",{parentName:"td"},"true")," value indicates eventing is enabled.")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"merchant_id")),(0,i.mdx)("td",{parentName:"tr",align:null},"string"),(0,i.mdx)("td",{parentName:"tr",align:null},"The merchant's company name. The value can contain alphanumeric characters and underscores only.")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"environment_id")),(0,i.mdx)("td",{parentName:"tr",align:null},"string"),(0,i.mdx)("td",{parentName:"tr",align:null},"A label for your environment.")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"provider_id")),(0,i.mdx)("td",{parentName:"tr",align:null},"string"),(0,i.mdx)("td",{parentName:"tr",align:null},"An event provider ID generated by the ",(0,i.mdx)("a",{parentName:"td",href:"./commands.md#create-an-event-provider"},(0,i.mdx)("inlineCode",{parentName:"a"},"bin/magento events:create-event-provider")," command"),".")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"instance_id")),(0,i.mdx)("td",{parentName:"tr",align:null},"string"),(0,i.mdx)("td",{parentName:"tr",align:null},"A unique identifier. This value can contain English alphanumeric characters, underscores (_), and hyphens (-) only.")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"workspace_configuration")),(0,i.mdx)("td",{parentName:"tr",align:null},"string"),(0,i.mdx)("td",{parentName:"tr",align:null},"The contents of the workspace configuration file downloaded from the Adobe Developer Console.")))),(0,i.mdx)("p",null,(0,i.mdx)("strong",{parentName:"p"},"Example usage:")),(0,i.mdx)("p",null,"The following cURL command updates the eventing configuration:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-bash"},'curl -i -X PUT \\\n   -H "Content-Type:application/json" \\\n   -H "Authorization:Bearer <AUTH_TOKEN>" \\\n   -d \\\n\'{\n  "config": {\n    "enabled": 1,\n    "merchant_id":  "test_merchant",\n    "environment_id":  "test_environment",\n    "instance_id":  "my_instance_id",\n    "provider_id":  "1902bc50-12345-41e8-955b-af4a9667823f",\n    "workspace_configuration": "{\\"project\\":{\\"id\\":\\"12324124123123\\",\\"name\\":\\"884CoralMockingbird\\",\\"title\\":\\"Test Project\\",\\"org\\":{\\"id\\":\\"123455\\",\\"name\\":\\"my-org-name\\",\\"ims_org_id\\":\\"12321423414134@AdobeOrg\\"},\\"workspace\\":{\\"id\\":\\"123455\\",\\"name\\":\\"Stage\\",\\"title\\":\\"Stage\\",\\"action_url\\":\\"https://custom-url-stage.adobeioruntime.net\\",\\"app_url\\":\\"https://custom-url-stage.adobeio-static.net\\",\\"details\\":{\\"credentials\\":[{\\"id\\":\\"581153\\",\\"name\\":\\"Credential in Beta3php83test - Stage\\",\\"integration_type\\":\\"oauth_server_to_server\\",\\"oauth_server_to_server\\":{\\"client_id\\":\\"xxxxxxx\\",\\"client_secrets\\":[\\"p8e-xxxxx-xxx\\"],\\"technical_account_email\\":\\"xxxxx@techacct.adobe.com\\",\\"technical_account_id\\":\\"xxxxx@techacct.adobe.com\\",\\"scopes\\":[\\"AdobeID\\",\\"openid\\",\\"read_organizations\\",\\"additional_info.projectedProductContext\\",\\"additional_info.roles\\",\\"adobeio_api\\",\\"read_client_secret\\",\\"manage_client_secrets\\"]}}],\\"services\\":[{\\"code\\":\\"AdobeIOManagementAPISDK\\",\\"name\\":\\"I/O Management API\\"},{\\"code\\":\\"commerceeventing\\",\\"name\\":\\"Adobe I/O Events for Adobe Commerce\\"}],\\"runtime\\":{\\"namespaces\\":[{\\"name\\":\\"1339710-884coralmockingbird-stage\\",\\"auth\\":\\"xxxxxxxxxxx\\"}]},\\"events\\":{\\"registrations\\":[]},\\"mesh\\":{}}}}}"\n  }\n}\' \\\n \'<ADOBE_COMMERCE_URL>/rest/all/V1/eventing/updateConfiguration\'\n')))}u.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-events-api-md-1c835d0ffd6574a92c43.js.map