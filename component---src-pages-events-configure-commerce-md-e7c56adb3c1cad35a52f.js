"use strict";(self.webpackChunkcommerce_extensibility=self.webpackChunkcommerce_extensibility||[]).push([[4395],{19165:function(e,t,a){a.r(t),a.d(t,{_frontmatter:function(){return p},default:function(){return g}});var n=a(58168),i=a(80045),r=(a(88763),a(15680)),o=a(83407);const m=["components"],p={},s=(c="InlineAlert",function(e){return console.warn("Component "+c+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.mdx)("div",e)});var c;const d={_frontmatter:p},l=o.A;function g(e){let{components:t}=e,a=(0,i.A)(e,m);return(0,r.mdx)(l,(0,n.A)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,r.mdx)("h1",{id:"configure-adobe-commerce"},"Configure Adobe Commerce"),(0,r.mdx)("p",null,"After you have created an ",(0,r.mdx)("a",{parentName:"p",href:"./project-setup.md"},"App Builder project")," and ",(0,r.mdx)("a",{parentName:"p",href:"./installation.md"},"install the eventing modules"),", you must download several files from the App Builder project and configure eventing in the Commerce admin."),(0,r.mdx)("h2",{id:"configure-the-adobe-io-connection"},"Configure the Adobe I/O connection"),(0,r.mdx)("p",null,"You must configure Commerce to communicate with your project. Configuration includes copying and pasting the contents of the ",(0,r.mdx)("a",{parentName:"p",href:"./project-setup.md#download-the-workspace-configuration-file"},"workspace configuration file")," that you downloaded from the Adobe Developer Console. If you decided to use JSON Web Tokens (JWT) as your server-to server authentication method, you must also upload a private key."),(0,r.mdx)("ol",null,(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"In the Commerce Admin, navigate to ",(0,r.mdx)("strong",{parentName:"p"},"Stores")," > Settings > ",(0,r.mdx)("strong",{parentName:"p"},"Configuration")," > ",(0,r.mdx)("strong",{parentName:"p"},"Adobe Services")," > ",(0,r.mdx)("strong",{parentName:"p"},"Adobe I/O Events")," > ",(0,r.mdx)("strong",{parentName:"p"},"General configuration"),". The following screen displays."),(0,r.mdx)("p",{parentName:"li"},(0,r.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1175px"}},"\n      ",(0,r.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"47.8125%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,r.mdx)("picture",{parentName:"span"},"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-extensibility/static/b1d88e551c52fdfe28d70f4f6f910887/5530d/general-configuration-empty.webp 320w","/commerce-extensibility/static/b1d88e551c52fdfe28d70f4f6f910887/0c8fb/general-configuration-empty.webp 640w","/commerce-extensibility/static/b1d88e551c52fdfe28d70f4f6f910887/72726/general-configuration-empty.webp 1175w"],sizes:"(max-width: 1175px) 100vw, 1175px",type:"image/webp"}),"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-extensibility/static/b1d88e551c52fdfe28d70f4f6f910887/dd4a7/general-configuration-empty.png 320w","/commerce-extensibility/static/b1d88e551c52fdfe28d70f4f6f910887/0f09e/general-configuration-empty.png 640w","/commerce-extensibility/static/b1d88e551c52fdfe28d70f4f6f910887/bf24a/general-configuration-empty.png 1175w"],sizes:"(max-width: 1175px) 100vw, 1175px",type:"image/png"}),"\n          ",(0,r.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/commerce-extensibility/static/b1d88e551c52fdfe28d70f4f6f910887/bf24a/general-configuration-empty.png",alt:"General configuration",title:"General configuration",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    "))),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Select the server-to-server authorization method you implemented from the ",(0,r.mdx)("strong",{parentName:"p"},"Adobe I/O Authorization Type")," menu. Adobe recommends using OAuth. JWT has been deprecated.")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"(JWT only) Copy and paste the contents of your ",(0,r.mdx)("inlineCode",{parentName:"p"},"private.key")," file into the ",(0,r.mdx)("strong",{parentName:"p"},"Service Account Private Key")," field. Use the following command to copy the contents."),(0,r.mdx)("pre",{parentName:"li"},(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},"cat config/private.key | pbcopy\n")),(0,r.mdx)("p",{parentName:"li"},"See ",(0,r.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/developer-console/docs/guides/authentication/JWT/"},"Service Account (JWT) Authentication")," for more information about the ",(0,r.mdx)("inlineCode",{parentName:"p"},"private.key")," file.")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Copy the entire contents of the ",(0,r.mdx)("inlineCode",{parentName:"p"},"<workspace-name>.json")," file into the ",(0,r.mdx)("strong",{parentName:"p"},"Adobe I/O Workspace Configuration")," field.")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Enter a unique identifier in the ",(0,r.mdx)("strong",{parentName:"p"},"Adobe Commerce Instance ID")," field. This unique value identifies your Commerce instance, which allows Commerce events to connect to the correct ",(0,r.mdx)("inlineCode",{parentName:"p"},"Event Provider")," in Adobe I/O. This ID corresponds to the ",(0,r.mdx)("strong",{parentName:"p"},"Provider")," displayed when ",(0,r.mdx)("a",{parentName:"p",href:"#subscribe-and-register-events"},"subscribing to events"),"."),(0,r.mdx)("p",{parentName:"li"},(0,r.mdx)("strong",{parentName:"p"},"Note"),": The ",(0,r.mdx)("strong",{parentName:"p"},"Adobe Commerce Instance ID")," field only supports alphanumeric characters, hyphens and underscores.")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Click ",(0,r.mdx)("strong",{parentName:"p"},"Save Config"),", but do not leave the page. The next section creates an event provider, which is necessary to complete the configuration."),(0,r.mdx)("p",{parentName:"li"},"The event provider will not appear in the Developer Console until after you subscribe to an event emitted by Commerce, such as ",(0,r.mdx)("inlineCode",{parentName:"p"},"io_events.xml")," or ",(0,r.mdx)("inlineCode",{parentName:"p"},"config.php"),"."))),(0,r.mdx)("h2",{id:"create-an-event-provider"},"Create an event provider"),(0,r.mdx)("p",null,"Create an event provider in Adobe I/O Events to associate the Commerce Events subscriptions with the provider. The event subscriptions in Adobe Commerce are created as event metadata in Adobe I/O Events infrastructure."),(0,r.mdx)("p",null,"Each event provider can link to multiple event subscriptions (event metadata). The event's subscriptions will be automatically linked to your event provider whenever you subscribe with the ",(0,r.mdx)("inlineCode",{parentName:"p"},"events:subscribe")," command. You can also manually synchronize all subscriptions with the ",(0,r.mdx)("inlineCode",{parentName:"p"},"events:metadata:populate")," command or by clicking the ",(0,r.mdx)("strong",{parentName:"p"},"Execute Synchronization")," button on the ",(0,r.mdx)("strong",{parentName:"p"},"General configuration")," section of the Adobe I/O Events page in the Admin. Running the ",(0,r.mdx)("inlineCode",{parentName:"p"},"setup:upgrade")," command also synchronizes events subscriptions."),(0,r.mdx)("p",null,"You can find the list of event providers created in your organization, in the App Builder UI when ",(0,r.mdx)("a",{parentName:"p",href:"#subscribe-and-register-events"},"creating an Event Registration in App Builder"),"."),(0,r.mdx)("p",null,"You can also use the ",(0,r.mdx)("inlineCode",{parentName:"p"},"aio")," CLI tool to manage providers. See ",(0,r.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/events/docs/guides/cli/#provider-commands"},"Provider Commands")," for more information."),(0,r.mdx)(s,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,r.mdx)("p",null,"You cannot create an event provider until you have configured and saved instance ID values and a workspace file. If you are using JWT for server-to-server authentication, you must have previously specified the private key."),(0,r.mdx)("p",null,"You can create an event provider using either the ",(0,r.mdx)("a",{parentName:"p",href:"./configure-commerce.md#command-line"},"Command line")," or ",(0,r.mdx)("a",{parentName:"p",href:"./configure-commerce.md#commerce-admin"},"Commerce Admin"),"."),(0,r.mdx)("h3",{id:"command-line"},"Command line"),(0,r.mdx)("ol",null,(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Run the following command to create an event provider:"),(0,r.mdx)("pre",{parentName:"li"},(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},'bin/magento events:create-event-provider --label "Provider Label" --description "Provider description"\n')),(0,r.mdx)("p",{parentName:"li"},"For example:"),(0,r.mdx)("pre",{parentName:"li"},(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},'bin/magento events:create-event-provider --label "My_server_provider" --description "Provides out-of-process extensibility for Adobe Commerce"\n')),(0,r.mdx)("p",{parentName:"li"},"The ",(0,r.mdx)("inlineCode",{parentName:"p"},"label")," field displays as the name of the created Event Provider in the App Builder UI. The ",(0,r.mdx)("inlineCode",{parentName:"p"},"description")," field provides more context about the Event Provider."),(0,r.mdx)("p",{parentName:"li"},(0,r.mdx)("strong",{parentName:"p"},"Note"),": The label can contain English alphanumeric characters, spaces, underscores (_), and hyphens (-) only. The first character must be a letter."),(0,r.mdx)("p",{parentName:"li"},"The command displays a message similar to the following:"),(0,r.mdx)("pre",{parentName:"li"},(0,r.mdx)("code",{parentName:"pre",className:"language-terminal"},"No event provider found, a new event provider will be created\nA new event provider has been created with ID ad667bc6-1678-49ff-99fc-215d71ebf82f\n"))),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Copy the ID returned in the command output into the ",(0,r.mdx)("strong",{parentName:"p"},"Adobe I/O Event Provider ID")," field in the Admin."),(0,r.mdx)("p",{parentName:"li"},(0,r.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1177px"}},"\n      ",(0,r.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"44.375%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,r.mdx)("picture",{parentName:"span"},"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-extensibility/static/ac4a2facb30239f383423b078d727fde/5530d/general-configuration-providerId-cli.webp 320w","/commerce-extensibility/static/ac4a2facb30239f383423b078d727fde/0c8fb/general-configuration-providerId-cli.webp 640w","/commerce-extensibility/static/ac4a2facb30239f383423b078d727fde/915d9/general-configuration-providerId-cli.webp 1177w"],sizes:"(max-width: 1177px) 100vw, 1177px",type:"image/webp"}),"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-extensibility/static/ac4a2facb30239f383423b078d727fde/dd4a7/general-configuration-providerId-cli.png 320w","/commerce-extensibility/static/ac4a2facb30239f383423b078d727fde/0f09e/general-configuration-providerId-cli.png 640w","/commerce-extensibility/static/ac4a2facb30239f383423b078d727fde/52180/general-configuration-providerId-cli.png 1177w"],sizes:"(max-width: 1177px) 100vw, 1177px",type:"image/png"}),"\n          ",(0,r.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/commerce-extensibility/static/ac4a2facb30239f383423b078d727fde/52180/general-configuration-providerId-cli.png",alt:"General configuration updated",title:"General configuration updated",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")))),(0,r.mdx)("h3",{id:"commerce-admin"},"Commerce Admin"),(0,r.mdx)("ol",null,(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"In the Commerce Admin, navigate to ",(0,r.mdx)("strong",{parentName:"p"},"Stores")," > Settings > ",(0,r.mdx)("strong",{parentName:"p"},"Configuration")," > ",(0,r.mdx)("strong",{parentName:"p"},"Adobe Services")," > ",(0,r.mdx)("strong",{parentName:"p"},"Adobe I/O Events")," > ",(0,r.mdx)("strong",{parentName:"p"},"General configuration"),". The following screen displays."),(0,r.mdx)("p",{parentName:"li"},(0,r.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1173px"}},"\n      ",(0,r.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"46.5625%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,r.mdx)("picture",{parentName:"span"},"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-extensibility/static/7eb250c41ed8210e52afc8820c2b4fee/5530d/general-configuration-instanceId.webp 320w","/commerce-extensibility/static/7eb250c41ed8210e52afc8820c2b4fee/0c8fb/general-configuration-instanceId.webp 640w","/commerce-extensibility/static/7eb250c41ed8210e52afc8820c2b4fee/4954c/general-configuration-instanceId.webp 1173w"],sizes:"(max-width: 1173px) 100vw, 1173px",type:"image/webp"}),"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-extensibility/static/7eb250c41ed8210e52afc8820c2b4fee/dd4a7/general-configuration-instanceId.png 320w","/commerce-extensibility/static/7eb250c41ed8210e52afc8820c2b4fee/0f09e/general-configuration-instanceId.png 640w","/commerce-extensibility/static/7eb250c41ed8210e52afc8820c2b4fee/1085b/general-configuration-instanceId.png 1173w"],sizes:"(max-width: 1173px) 100vw, 1173px",type:"image/png"}),"\n          ",(0,r.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/commerce-extensibility/static/7eb250c41ed8210e52afc8820c2b4fee/1085b/general-configuration-instanceId.png",alt:"General configuration",title:"General configuration",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    "))),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Click on the ",(0,r.mdx)("strong",{parentName:"p"},"Create Event Provider")," button, enter the ",(0,r.mdx)("strong",{parentName:"p"},"Label")," and ",(0,r.mdx)("strong",{parentName:"p"},"Description"),", and then click submit. The ",(0,r.mdx)("strong",{parentName:"p"},"Adobe I/O Event Provider ID")," field will be populated with the newly generated event provider ID"),(0,r.mdx)("p",{parentName:"li"},(0,r.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,r.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"21.875%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,r.mdx)("picture",{parentName:"span"},"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-extensibility/static/df9b8d026145dad04267fb87e1222fe4/5530d/general-configuration-providerInfo.webp 320w","/commerce-extensibility/static/df9b8d026145dad04267fb87e1222fe4/0c8fb/general-configuration-providerInfo.webp 640w","/commerce-extensibility/static/df9b8d026145dad04267fb87e1222fe4/94b1e/general-configuration-providerInfo.webp 1280w","/commerce-extensibility/static/df9b8d026145dad04267fb87e1222fe4/5e6d6/general-configuration-providerInfo.webp 1427w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-extensibility/static/df9b8d026145dad04267fb87e1222fe4/dd4a7/general-configuration-providerInfo.png 320w","/commerce-extensibility/static/df9b8d026145dad04267fb87e1222fe4/0f09e/general-configuration-providerInfo.png 640w","/commerce-extensibility/static/df9b8d026145dad04267fb87e1222fe4/bbbf7/general-configuration-providerInfo.png 1280w","/commerce-extensibility/static/df9b8d026145dad04267fb87e1222fe4/569fb/general-configuration-providerInfo.png 1427w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,r.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/commerce-extensibility/static/df9b8d026145dad04267fb87e1222fe4/bbbf7/general-configuration-providerInfo.png",alt:"General configuration",title:"General configuration",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,r.mdx)("p",{parentName:"li"},(0,r.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,r.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"37.5%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,r.mdx)("picture",{parentName:"span"},"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-extensibility/static/70e22788f04efcc6110d9bad6168d181/5530d/general-configuration-providerId-adminui.webp 320w","/commerce-extensibility/static/70e22788f04efcc6110d9bad6168d181/0c8fb/general-configuration-providerId-adminui.webp 640w","/commerce-extensibility/static/70e22788f04efcc6110d9bad6168d181/94b1e/general-configuration-providerId-adminui.webp 1280w","/commerce-extensibility/static/70e22788f04efcc6110d9bad6168d181/6ce5e/general-configuration-providerId-adminui.webp 1653w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-extensibility/static/70e22788f04efcc6110d9bad6168d181/dd4a7/general-configuration-providerId-adminui.png 320w","/commerce-extensibility/static/70e22788f04efcc6110d9bad6168d181/0f09e/general-configuration-providerId-adminui.png 640w","/commerce-extensibility/static/70e22788f04efcc6110d9bad6168d181/bbbf7/general-configuration-providerId-adminui.png 1280w","/commerce-extensibility/static/70e22788f04efcc6110d9bad6168d181/189e1/general-configuration-providerId-adminui.png 1653w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,r.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/commerce-extensibility/static/70e22788f04efcc6110d9bad6168d181/bbbf7/general-configuration-providerId-adminui.png",alt:"General configuration",title:"General configuration",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")))),(0,r.mdx)("h2",{id:"complete-the-commerce-configuration"},"Complete the Commerce configuration"),(0,r.mdx)("ol",null,(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Enable Commerce Eventing by setting ",(0,r.mdx)("strong",{parentName:"p"},"Enabled")," to ",(0,r.mdx)("inlineCode",{parentName:"p"},"Yes"),"."),(0,r.mdx)("p",{parentName:"li"},(0,r.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,r.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"29.6875%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,r.mdx)("picture",{parentName:"span"},"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-extensibility/static/16b6ba5f9692e7c326f4b7a77c4e6450/5530d/commerce-events.webp 320w","/commerce-extensibility/static/16b6ba5f9692e7c326f4b7a77c4e6450/0c8fb/commerce-events.webp 640w","/commerce-extensibility/static/16b6ba5f9692e7c326f4b7a77c4e6450/94b1e/commerce-events.webp 1280w","/commerce-extensibility/static/16b6ba5f9692e7c326f4b7a77c4e6450/2da40/commerce-events.webp 1345w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-extensibility/static/16b6ba5f9692e7c326f4b7a77c4e6450/dd4a7/commerce-events.png 320w","/commerce-extensibility/static/16b6ba5f9692e7c326f4b7a77c4e6450/0f09e/commerce-events.png 640w","/commerce-extensibility/static/16b6ba5f9692e7c326f4b7a77c4e6450/bbbf7/commerce-events.png 1280w","/commerce-extensibility/static/16b6ba5f9692e7c326f4b7a77c4e6450/5d169/commerce-events.png 1345w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,r.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/commerce-extensibility/static/16b6ba5f9692e7c326f4b7a77c4e6450/bbbf7/commerce-events.png",alt:"Commerce events configuration",title:"Commerce events configuration",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,r.mdx)("p",{parentName:"li"},(0,r.mdx)("strong",{parentName:"p"},"Note"),": You must ",(0,r.mdx)("a",{parentName:"p",href:"#check-cron-and-message-queue-configuration"},"enable cron")," so that Commerce can send events to the endpoint.")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Enter the merchant's company name in the ",(0,r.mdx)("strong",{parentName:"p"},"Merchant ID")," and the environment name in ",(0,r.mdx)("strong",{parentName:"p"},"Environment ID")," fields. The values of these fields will be combined and added as a ",(0,r.mdx)("inlineCode",{parentName:"p"},"source")," attribute to your event data to identify the source of the events. It can be useful for event filtration or other logic if you are using the same event provider for several environments or projects."),(0,r.mdx)("p",{parentName:"li"},(0,r.mdx)("strong",{parentName:"p"},"Note"),": The ",(0,r.mdx)("strong",{parentName:"p"},"Merchant ID")," and ",(0,r.mdx)("strong",{parentName:"p"},"Environment ID")," fields only support alphanumeric characters and underscores."))),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-javascript"},'"source": "<merchant-id>.<environment-id>"\n')),(0,r.mdx)("ol",null,(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"(Optional) By default, if an error occurs when Adobe Commerce attempts to send an event to Adobe I/O, Commerce retries a maximum of seven times. To change this value, uncheck the ",(0,r.mdx)("strong",{parentName:"p"},"Use system value")," checkbox and set a new value in the ",(0,r.mdx)("strong",{parentName:"p"},"Maximum retries to send events")," field.")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"(Optional) By default, Adobe Commerce runs a cron job (clean_event_data) every 24 hours that deletes event data that is three days old. To change the number of days to retain event data, uncheck the ",(0,r.mdx)("strong",{parentName:"p"},"Use system value")," checkbox and set a new value in the ",(0,r.mdx)("strong",{parentName:"p"},"Event retention time (in days)")," field.")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Click ",(0,r.mdx)("strong",{parentName:"p"},"Save Config"),"."))),(0,r.mdx)("p",null,"After you have completely configured and saved your Adobe I/O event connection and your event provider, you can click the ",(0,r.mdx)("strong",{parentName:"p"},"Send Test Event")," button to determine the status of the connection. The response displays beneath the button."),(0,r.mdx)("h2",{id:"subscribe-and-register-events"},"Subscribe and register events"),(0,r.mdx)("p",null,"You must define which Commerce events to subscribe to, then register them in the project."),(0,r.mdx)("p",null,"Commerce provides two sources for events: observers and plugins. You must specify the source as part of the event name. See ",(0,r.mdx)("a",{parentName:"p",href:"./commands.md"},"Subscribe to a Commerce event")," for details about the syntax of the ",(0,r.mdx)("inlineCode",{parentName:"p"},"events:subscribe")," command."),(0,r.mdx)("ol",null,(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"If you don't have a module ready for integration with Adobe I/O Events, or you don't know exactly which events to register at this point, use the ",(0,r.mdx)("inlineCode",{parentName:"p"},"events:subscribe")," command to subscribe to some sample events, as shown in the following example commands:"),(0,r.mdx)("pre",{parentName:"li"},(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},"bin/magento events:subscribe observer.catalog_product_save_after --fields=sku --fields=stock_data.qty\n")),(0,r.mdx)("pre",{parentName:"li"},(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},"bin/magento events:subscribe observer.customer_login --fields=customer.firstname --fields=customer.lastname\n")),(0,r.mdx)("p",{parentName:"li"}," ",(0,r.mdx)("strong",{parentName:"p"},"Warning"),": When you use the ",(0,r.mdx)("inlineCode",{parentName:"p"},"events:subscribe")," command to subscribe to events on a Cloud environment, configuration information is stored in the ",(0,r.mdx)("inlineCode",{parentName:"p"},"app/etc/config.php")," file. You must keep in mind that this file can be replaced with the ",(0,r.mdx)("inlineCode",{parentName:"p"},"app/etc/config.php")," file from Git during deployment. As a result, the event subscription will be replaced as well.\nTo make these changes permanent, manually add the appropriate configuration to the ",(0,r.mdx)("inlineCode",{parentName:"p"},"app/etc/config.php")," file under Git."),(0,r.mdx)("p",{parentName:"li"},"If you have a module ready or have specific events in mind, see ",(0,r.mdx)("a",{parentName:"p",href:"./module-development.md#register-events"},"Register events")," for more information.")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Return to your workspace. Click the ",(0,r.mdx)("strong",{parentName:"p"},"Add service")," pop-up menu and select ",(0,r.mdx)("strong",{parentName:"p"},"Event"),"."),(0,r.mdx)("p",{parentName:"li"},(0,r.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"612px"}},"\n      ",(0,r.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"45.3125%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,r.mdx)("picture",{parentName:"span"},"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-extensibility/static/0a05702164a276dd373bf7edf42f383d/5530d/add-event.webp 320w","/commerce-extensibility/static/0a05702164a276dd373bf7edf42f383d/d408e/add-event.webp 612w"],sizes:"(max-width: 612px) 100vw, 612px",type:"image/webp"}),"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-extensibility/static/0a05702164a276dd373bf7edf42f383d/dd4a7/add-event.png 320w","/commerce-extensibility/static/0a05702164a276dd373bf7edf42f383d/dbf98/add-event.png 612w"],sizes:"(max-width: 612px) 100vw, 612px",type:"image/png"}),"\n          ",(0,r.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/commerce-extensibility/static/0a05702164a276dd373bf7edf42f383d/dbf98/add-event.png",alt:"Click Add service in your workspace",title:"Click Add service in your workspace",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    "))),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"On the ",(0,r.mdx)("strong",{parentName:"p"},"Add events")," page, select ",(0,r.mdx)("strong",{parentName:"p"},"Commerce events"),". Then click ",(0,r.mdx)("strong",{parentName:"p"},"Next"),"."),(0,r.mdx)("p",{parentName:"li"},(0,r.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1113px"}},"\n      ",(0,r.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"58.75%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,r.mdx)("picture",{parentName:"span"},"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-extensibility/static/1c9afe4057190c9edc859d5e2a57c83b/5530d/select-commerce-event.webp 320w","/commerce-extensibility/static/1c9afe4057190c9edc859d5e2a57c83b/0c8fb/select-commerce-event.webp 640w","/commerce-extensibility/static/1c9afe4057190c9edc859d5e2a57c83b/7f140/select-commerce-event.webp 1113w"],sizes:"(max-width: 1113px) 100vw, 1113px",type:"image/webp"}),"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-extensibility/static/1c9afe4057190c9edc859d5e2a57c83b/dd4a7/select-commerce-event.png 320w","/commerce-extensibility/static/1c9afe4057190c9edc859d5e2a57c83b/0f09e/select-commerce-event.png 640w","/commerce-extensibility/static/1c9afe4057190c9edc859d5e2a57c83b/6efed/select-commerce-event.png 1113w"],sizes:"(max-width: 1113px) 100vw, 1113px",type:"image/png"}),"\n          ",(0,r.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/commerce-extensibility/static/1c9afe4057190c9edc859d5e2a57c83b/6efed/select-commerce-event.png",alt:"Select Commerce events",title:"Select Commerce events",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,r.mdx)("p",{parentName:"li"},(0,r.mdx)("strong",{parentName:"p"},"Note:")," If the ",(0,r.mdx)("strong",{parentName:"p"},"Commerce events")," category is not shown, check that you have created an event provider, and that it has at least one subscribed event. You may need to run the ",(0,r.mdx)("inlineCode",{parentName:"p"},"bin/magento events:metadata:populate")," command to synchronize event registrations in Adobe Commerce with the created event provider.")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"On the ",(0,r.mdx)("strong",{parentName:"p"},"Configure event registration")," page, select your event provider. Then click ",(0,r.mdx)("strong",{parentName:"p"},"Next"),".")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Select the events to subscribe to. Then click ",(0,r.mdx)("strong",{parentName:"p"},"Next"),"."),(0,r.mdx)("p",{parentName:"li"},(0,r.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1214px"}},"\n      ",(0,r.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"46.25%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,r.mdx)("picture",{parentName:"span"},"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-extensibility/static/12301d8f4531c45cbabd2e63796639cf/5530d/config-event-registration.webp 320w","/commerce-extensibility/static/12301d8f4531c45cbabd2e63796639cf/0c8fb/config-event-registration.webp 640w","/commerce-extensibility/static/12301d8f4531c45cbabd2e63796639cf/32dd4/config-event-registration.webp 1214w"],sizes:"(max-width: 1214px) 100vw, 1214px",type:"image/webp"}),"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-extensibility/static/12301d8f4531c45cbabd2e63796639cf/dd4a7/config-event-registration.png 320w","/commerce-extensibility/static/12301d8f4531c45cbabd2e63796639cf/0f09e/config-event-registration.png 640w","/commerce-extensibility/static/12301d8f4531c45cbabd2e63796639cf/2ed29/config-event-registration.png 1214w"],sizes:"(max-width: 1214px) 100vw, 1214px",type:"image/png"}),"\n          ",(0,r.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/commerce-extensibility/static/12301d8f4531c45cbabd2e63796639cf/2ed29/config-event-registration.png",alt:"Select the events to subscribe to",title:"Select the events to subscribe to",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    "))),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Optionally create a new OAuth or JWT credential. Then click ",(0,r.mdx)("strong",{parentName:"p"},"Next"),".")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Update the ",(0,r.mdx)("strong",{parentName:"p"},"Event registration name")," and ",(0,r.mdx)("strong",{parentName:"p"},"Event registration description")," fields. The Journaling API can consume your events by default. You can optionally select other consumption methods during this step. Learn more about your options in ",(0,r.mdx)("a",{parentName:"p",href:"./consume-events.md"},"Consuming Events"),"."),(0,r.mdx)("p",{parentName:"li"},(0,r.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,r.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"56.56250000000001%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,r.mdx)("picture",{parentName:"span"},"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-extensibility/static/a716b970997c6b2c9fef52dad914352b/5530d/receive-events-options.webp 320w","/commerce-extensibility/static/a716b970997c6b2c9fef52dad914352b/0c8fb/receive-events-options.webp 640w","/commerce-extensibility/static/a716b970997c6b2c9fef52dad914352b/94b1e/receive-events-options.webp 1280w","/commerce-extensibility/static/a716b970997c6b2c9fef52dad914352b/0b34d/receive-events-options.webp 1920w","/commerce-extensibility/static/a716b970997c6b2c9fef52dad914352b/fdd3a/receive-events-options.webp 2458w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-extensibility/static/a716b970997c6b2c9fef52dad914352b/dd4a7/receive-events-options.png 320w","/commerce-extensibility/static/a716b970997c6b2c9fef52dad914352b/0f09e/receive-events-options.png 640w","/commerce-extensibility/static/a716b970997c6b2c9fef52dad914352b/bbbf7/receive-events-options.png 1280w","/commerce-extensibility/static/a716b970997c6b2c9fef52dad914352b/ac7a9/receive-events-options.png 1920w","/commerce-extensibility/static/a716b970997c6b2c9fef52dad914352b/219e3/receive-events-options.png 2458w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,r.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/commerce-extensibility/static/a716b970997c6b2c9fef52dad914352b/bbbf7/receive-events-options.png",alt:"Select how to receive events",title:"Select how to receive events",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    "))),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Select ",(0,r.mdx)("strong",{parentName:"p"},"Save configured events"),"."))),(0,r.mdx)("p",null,"You are now set up to develop your App Builder extension."),(0,r.mdx)("h2",{id:"optional-set-up-an-app-builder-project-with-event-registrations-and-runtime-actions"},"(Optional) Set up an App Builder project with event registrations and runtime actions"),(0,r.mdx)("p",null,"If you want to add ",(0,r.mdx)("inlineCode",{parentName:"p"},"Event Registrations")," with ",(0,r.mdx)("inlineCode",{parentName:"p"},"Runtime Actions")," as event consumers, you can use the App Builder template ",(0,r.mdx)("strong",{parentName:"p"},"@adobe/generator-app-events-generic")," to easily set up your project."),(0,r.mdx)("ol",null,(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Create a project directory on your local filesystem and change to that directory."),(0,r.mdx)("pre",{parentName:"li"},(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},"mkdir myproject && cd myproject\n"))),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Log in to Adobe IO from a terminal:"),(0,r.mdx)("pre",{parentName:"li"},(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},"aio login\n")),(0,r.mdx)("p",{parentName:"li"},"Your web browser displays the login page.")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Enter your Adobe ID credentials.")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Close the browser tab and return to your terminal. Enter the following command to bootstrap your application:"),(0,r.mdx)("pre",{parentName:"li"},(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},"aio app init -w <workspace-name>\n")),(0,r.mdx)("p",{parentName:"li"},"The terminal prompts you to select the path to your workspace."),(0,r.mdx)("ul",{parentName:"li"},(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("p",{parentName:"li"},"Select your project's organization.")),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("p",{parentName:"li"},"Select your project.")),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("p",{parentName:"li"},"Select the ",(0,r.mdx)("strong",{parentName:"p"},"@adobe/generator-app-events-generic")," option using ","<","space> and press ","<","enter>."),(0,r.mdx)("pre",{parentName:"li"},(0,r.mdx)("code",{parentName:"pre",className:"language-terminal"},"? Select Org: MyOrg\n? Select a Project, or press + to create new: DeveloperSandbox\n? What templates do you want to search for? All Templates\n✔ Downloaded the list of templates\n? Choose the template(s) to install:\nPressing <enter> without selection will skip templates and install a standalone application.\n\n┌──────┬─────────────────────────────────────────────────────────────┬─────────────────────────────────────────────────────────────┬────────────────────────────────────────┬────────────────────────────────────────┐\n│      │ Template                                                    │ Description                                                 │ Extension Point                        │ Categories                             │\n├──────┼─────────────────────────────────────────────────────────────┼─────────────────────────────────────────────────────────────┼────────────────────────────────────────┼────────────────────────────────────────┤\n│ ❯◉   │ @adobe/generator-app-events-generic *                       │ Adds event registrations and a generic action               │ N/A                                    │ action, events                         │\n├──────┼─────────────────────────────────────────────────────────────┼─────────────────────────────────────────────────────────────┼────────────────────────────────────────┼────────────────────────────────────────┤\n│  ◯   │ @adobe/aem-cf-editor-ui-ext-tpl *                           │ Extensibility template for AEM Content Fragment Editor      │ aem/cf-editor/1                        │ action, ui                             │\n├──────┼─────────────────────────────────────────────────────────────┼─────────────────────────────────────────────────────────────┼────────────────────────────────────────┼────────────────────────────────────────┤\n│  ◯   │ @adobe/generator-app-aem-react *                            │ Template for AEM React SPA based on WKND content.           │ N/A                                    │ ui                                     │\n├──────┼─────────────────────────────────────────────────────────────┼─────────────────────────────────────────────────────────────┼────────────────────────────────────────┼────────────────────────────────────────┤\n│  ◯   │ @adobe/aem-cf-admin-ui-ext-tpl *                            │ Extensibility template for AEM Content Fragment Admin       │ aem/cf-console-admin/1                 │ action, ui                             │\n│      │                                                             │ Console                                                     │                                        │                                        │\n└──────┴─────────────────────────────────────────────────────────────┴─────────────────────────────────────────────────────────────┴────────────────────────────────────────┴────────────────────────────────────────┘\n"))),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("p",{parentName:"li"},"Enter the name of the non-web Runtime Action. The default value is ",(0,r.mdx)("inlineCode",{parentName:"p"},"generic"),"."),(0,r.mdx)("pre",{parentName:"li"},(0,r.mdx)("code",{parentName:"pre",className:"language-terminal"},"✔ Installed npm package @adobe/generator-app-events-generic\nℹ Running template @adobe/generator-app-events-generic\n? We are about to create a new sample action that A generic action that logs the events received from IO Events.\nHow would you like to name this action? generic\n"))),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("p",{parentName:"li"},"Enter the name of event registration to create. The default value is ",(0,r.mdx)("inlineCode",{parentName:"p"},"Event Registration"),"."),(0,r.mdx)("pre",{parentName:"li"},(0,r.mdx)("code",{parentName:"pre",className:"language-terminal"},"? We are about to create a new Event registration.\nHow would you like to name this registration? Customer Event Registration\n"))),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("p",{parentName:"li"},"Enter text that describes the purpose of the registration.  The default value is ",(0,r.mdx)("inlineCode",{parentName:"p"},"Registration for IO Events"),"."),(0,r.mdx)("pre",{parentName:"li"},(0,r.mdx)("code",{parentName:"pre",className:"language-terminal"},"? What is this registration being created for? Registration for receiving customer actions\n"))),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("p",{parentName:"li"},"Select ",(0,r.mdx)("inlineCode",{parentName:"p"},"Commerce Events")," from the list of event provider families."),(0,r.mdx)("pre",{parentName:"li"},(0,r.mdx)("code",{parentName:"pre",className:"language-terminal"},"? Choose from the following provider families ( provider metadata ) Commerce Events\n"))),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("p",{parentName:"li"},"Select the event provider you created in the ",(0,r.mdx)("a",{parentName:"p",href:"./configure-commerce.md#create-an-event-provider"},"Create an Event Provider")," section."),(0,r.mdx)("pre",{parentName:"li"},(0,r.mdx)("code",{parentName:"pre",className:"language-terminal"},"? Choose from below provider for provider metadata: dx_commerce_events team-mercury-sandbox\n"))),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("p",{parentName:"li"},"Select the event metadata you want to associate with the event registration."),(0,r.mdx)("pre",{parentName:"li"},(0,r.mdx)("code",{parentName:"pre",className:"language-terminal"},"Choose event metadata for provider: team-mercury-sandbox Observer event customer_login, Observer event customer_logout\n")))),(0,r.mdx)("p",{parentName:"li"},"The command initializes a project with a basic Adobe I/O Runtime Action and a configuration for the event registration.")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Deploy the generated application to the App Builder project by running the following command:"),(0,r.mdx)("pre",{parentName:"li"},(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},"aio app deploy\n")),(0,r.mdx)("p",{parentName:"li"},"The command deploys the project and creates a new event registration that delivers events to the Adobe I/O Runtime Action.")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"You can add more Adobe I/O Runtime actions or event registrations by editing the ",(0,r.mdx)("inlineCode",{parentName:"p"},"app.config.yaml")," file and redeploying the project with ",(0,r.mdx)("inlineCode",{parentName:"p"},"aio app deploy")," CLI command."),(0,r.mdx)("pre",{parentName:"li"},(0,r.mdx)("code",{parentName:"pre",className:"language-yaml"},"application:\n  runtimeManifest:\n    packages:\n      TemplateTest:\n        license: Apache-2.0\n        actions:\n          generic:\n            function: actions/generic/index.js\n            web: 'no'\n            runtime: nodejs:18\n            inputs:\n              LOG_LEVEL: debug\n            annotations:\n              require-adobe-auth: false\n              final: true\n  events:\n    registrations:\n      Customer Event Registration:\n        description: Registration for receiving customer actions\n        events_of_interest:\n          - provider_metadata: dx_commerce_events\n            event_codes:\n              - com.adobe.commerce.observer.customer_login\n              - com.adobe.commerce.observer.customer_logout\n        runtime_action: Stage/generic\n")))),(0,r.mdx)("p",null,(0,r.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/events/docs/guides/appbuilder/#initialising-an-app-builder-app-with-io-events-template"},"App Builder with IO Events")," provides additional information about setting up App Builder projects."),(0,r.mdx)("h2",{id:"check-cron-and-message-queue-configuration"},"Check cron and message queue configuration"),(0,r.mdx)("p",null,"Cron and message queues must be enabled. Commerce uses the ",(0,r.mdx)("inlineCode",{parentName:"p"},"event_data_batch_send")," cron job to transmit batches of event messages and the ",(0,r.mdx)("inlineCode",{parentName:"p"},"clean_event_data")," cron job to remove these messages from the database. These cron jobs are part of the ",(0,r.mdx)("inlineCode",{parentName:"p"},"default")," group."),(0,r.mdx)("p",null,"The ",(0,r.mdx)("inlineCode",{parentName:"p"},"commerce.eventing.event.publish")," message queue consumer helps expedite registered events that have been designated as priority. The consumer processes priority events within a second of their receipt. By default, it can take up to 59 seconds for cron to process standard-priority events."),(0,r.mdx)("p",null,"In Adobe Commerce on cloud infrastructure, update your ",(0,r.mdx)("inlineCode",{parentName:"p"},".magento.env.yaml")," file with the following changes to the ",(0,r.mdx)("inlineCode",{parentName:"p"},"global")," and ",(0,r.mdx)("inlineCode",{parentName:"p"},"deploy")," stages:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-yaml"},"stage:\n  global:\n    ENABLE_EVENTING: true\n  deploy:\n    CRON_CONSUMERS_RUNNER:\n      cron_run: true\n      max_messages: 0\n      consumers: []\n")),(0,r.mdx)(s,{variant:"warning",slots:"text",mdxType:"InlineAlert"}),(0,r.mdx)("p",null,"The deployment process might become stuck if the consumer runs in the background. The ",(0,r.mdx)("a",{parentName:"p",href:"./troubleshooting.md#stuck-deployment-after-configuring-priority-events"},"Troubleshooting")," topic describes how to resolve this condition."),(0,r.mdx)("p",null,"See ",(0,r.mdx)("a",{parentName:"p",href:"https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/configure/env/stage/variables-global.html"},"Global variables")," for more information about the ",(0,r.mdx)("inlineCode",{parentName:"p"},"ENABLE_EVENTING")," variable."),(0,r.mdx)("p",null,"Cloud infrastructure and on-premises instances require different cron management procedures as described here:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("p",{parentName:"li"},(0,r.mdx)("a",{parentName:"p",href:"https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/configure/app/properties/crons-property.html"},"Adobe Commerce on cloud infrastructure"))),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("p",{parentName:"li"},(0,r.mdx)("a",{parentName:"p",href:"https://experienceleague.adobe.com/docs/commerce-operations/configuration-guide/crons/custom-cron-reference.html"},"On premises")))))}g.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-events-configure-commerce-md-e7c56adb3c1cad35a52f.js.map